[
  {
    "objectID": "lab10.html",
    "href": "lab10.html",
    "title": "Lab 10: Distances and the Border Zone",
    "section": "",
    "text": "Libraries:\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(sf)\n\nLinking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(units)\n\nudunits database from /Users/tash/Library/R/x86_64/4.4/library/units/share/udunits/udunits2.xml\n\nlibrary(AOI)\nlibrary(gghighlight)\nlibrary(ggrepel)\nlibrary(knitr)\nlibrary(flextable)\n\n\nAttaching package: 'flextable'\n\nThe following object is masked from 'package:purrr':\n\n    compose"
  },
  {
    "objectID": "lab10.html#question-1",
    "href": "lab10.html#question-1",
    "title": "Lab 10: Distances and the Border Zone",
    "section": "Question 1:",
    "text": "Question 1:\nDefine a projection:\n\neqdc &lt;- '+proj=eqdc +lat_0=40 +lon_0=-96 +lat_1=20 +lat_2=60 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs'\n\nUSA State Boundaries:\n\nremotes::install_github(\"mikejohnson51/AOI\")\n\nUsing GitHub PAT from the git credential store.\n\n\nSkipping install of 'AOI' from a github remote, the SHA1 (f821d499) has not changed since last install.\n  Use `force = TRUE` to force installation\n\n\n\nusstates &lt;- aoi_get(state = 'conus')\n\nCountry Boundaries:\n\ncountbound &lt;- aoi_get(country = c(\"MX\", \"CA\", \"USA\"))\n\nCity Locations:\n\nuscities &lt;- read_csv('/Users/tash/git/lab10/simplemaps_uscities_basicv1.90/uscities.csv')\n\nRows: 31254 Columns: 17\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (9): city, city_ascii, state_id, state_name, county_fips, county_name, s...\ndbl (6): lat, lng, population, density, ranking, id\nlgl (2): military, incorporated\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n(uscities_sf &lt;- st_as_sf(uscities, coords = c(\"lng\", \"lat\"), crs = 4326))\n\nSimple feature collection with 31254 features and 15 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -176.6295 ymin: 17.9559 xmax: 174.111 ymax: 71.2727\nGeodetic CRS:  WGS 84\n# A tibble: 31,254 × 16\n   city        city_ascii state_id state_name county_fips county_name population\n * &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;            &lt;dbl&gt;\n 1 New York    New York   NY       New York   36081       Queens        18832416\n 2 Los Angeles Los Angel… CA       California 06037       Los Angeles   11885717\n 3 Chicago     Chicago    IL       Illinois   17031       Cook           8489066\n 4 Miami       Miami      FL       Florida    12086       Miami-Dade     6113982\n 5 Houston     Houston    TX       Texas      48201       Harris         6046392\n 6 Dallas      Dallas     TX       Texas      48113       Dallas         5843632\n 7 Philadelph… Philadelp… PA       Pennsylva… 42101       Philadelph…    5696588\n 8 Atlanta     Atlanta    GA       Georgia    13121       Fulton         5211164\n 9 Washington  Washington DC       District … 11001       District o…    5146120\n10 Boston      Boston     MA       Massachus… 25025       Suffolk        4355184\n# ℹ 31,244 more rows\n# ℹ 9 more variables: density &lt;dbl&gt;, source &lt;chr&gt;, military &lt;lgl&gt;,\n#   incorporated &lt;lgl&gt;, timezone &lt;chr&gt;, ranking &lt;dbl&gt;, zips &lt;chr&gt;, id &lt;dbl&gt;,\n#   geometry &lt;POINT [°]&gt;\n\n\n\nuscities_sf &lt;- uscities_sf %&gt;%\n  filter(!state_id %in% c(\"AK\", \"HI\", \"PR\"))"
  },
  {
    "objectID": "lab10.html#question-2",
    "href": "lab10.html#question-2",
    "title": "Lab 10: Distances and the Border Zone",
    "section": "Question 2:",
    "text": "Question 2:\nDistance to USA Boarder:\n\nusstates &lt;- st_transform(usstates, crs = eqdc)\ncountbound &lt;- st_transform(countbound, crs = eqdc)\n\n\nusa_border &lt;- st_union(usstates) %&gt;% \n  st_cast(\"MULTILINESTRING\")\n\n\nusa_border &lt;- st_transform(usa_border, crs = eqdc)\nuscities_sf &lt;- st_transform(uscities_sf, crs = eqdc)\n\n\nuscities_sf$usborder_dist &lt;- set_units(st_distance(uscities_sf, usa_border), \"km\")\n\n\nfar_usborder &lt;- uscities_sf %&gt;%\n  arrange(desc(usborder_dist)) %&gt;%\n  select(city, state_name, usborder_dist) %&gt;%\n  slice(1:5)\n\nflextable(far_usborder)\n\ncitystate_nameusborder_distgeometryMinneapolisKansas1,084.275 [km][[XY]]AdaKansas1,084.112 [km][[XY]]BarnardKansas1,083.737 [km][[XY]]ManchesterKansas1,080.210 [km][[XY]]TalmageKansas1,080.049 [km][[XY]]\n\n\nThe five farthest cities from the US border are all in Kansas. They include Minneapolis, Ada, Barnard, Manchester and Talmage.\nDistance to States:\n\nstate_borders &lt;- st_combine(usstates) %&gt;%\n  st_cast(\"MULTILINESTRING\")\n\n\nuscities_sf$state_border_dist &lt;- set_units(st_distance(uscities_sf, state_borders), \"km\")\n\n\nfar_state_border &lt;- uscities_sf %&gt;%\n  arrange(desc(state_border_dist)) %&gt;%\n  select(city, state_name, state_border_dist) %&gt;%\n  slice(1:5)\n\nflextable(far_state_border)\n\ncitystate_namestate_border_distgeometryBriggsTexas314.7901 [km][[XY]]LampasasTexas308.9002 [km][[XY]]FlorenceTexas304.0898 [km][[XY]]SaladoTexas302.8041 [km][[XY]]KempnerTexas302.5260 [km][[XY]]\n\n\nThe five cities farthest from their state border are all in Texas. These are Briggs, Lampasas, Florence, Salado, and Kempner.\nDistance to Mexico:\n\nmex_border &lt;- countbound %&gt;%\n  filter(name_long == \"Mexico\") %&gt;%\n  st_cast(\"MULTILINESTRING\")\n\n\nuscities_sf$mex_dist &lt;- set_units(st_distance(uscities_sf, mex_border), \"km\")\n\n\nfar_mex &lt;- uscities_sf %&gt;%\n  arrange(desc(mex_dist)) %&gt;%\n  select(city, state_name, mex_dist) %&gt;%\n  slice(1:5)\n\nflextable(far_mex)\n\ncitystate_namemex_distgeometryGrand IsleMaine3,282.825 [km][[XY]]CaribouMaine3,250.330 [km][[XY]]Presque IsleMaine3,234.570 [km][[XY]]OakfieldMaine3,175.577 [km][[XY]]Island FallsMaine3,162.285 [km][[XY]]\n\n\nThe five cities farthest from the Mexico border are all in Maine. These include Grand Isle,, Caribou, Presque Isle, Oakfield, and Island Falls.\nDistance To Canada:\n\ncan_border &lt;- countbound %&gt;%\n  filter(name_long == \"Canada\") %&gt;%\n  st_cast(\"MULTILINESTRING\")\n\n\nuscities_sf$can_dist &lt;- set_units(st_distance(uscities_sf, can_border), \"km\")\n\n\nfar_can &lt;- uscities_sf %&gt;%\n  arrange(desc(can_dist)) %&gt;%\n  select(city, state_name, can_dist) %&gt;%\n  slice(1:5)\n\nflextable(far_can)\n\ncitystate_namecan_distgeometryGuadalupe GuerraTexas2,206.455 [km][[XY]]SandovalTexas2,205.641 [km][[XY]]FrontonTexas2,204.794 [km][[XY]]Fronton RanchettesTexas2,202.118 [km][[XY]]EvergreenTexas2,202.020 [km][[XY]]\n\n\nThe five cities farthest from the Canada border are all in Texas. These include Guadalupe Guerra, Sandoval, Fronton, Fronton Ranchettes and Evergreen."
  },
  {
    "objectID": "lab10.html#question-3",
    "href": "lab10.html#question-3",
    "title": "Lab 10: Distances and the Border Zone",
    "section": "Question 3:",
    "text": "Question 3:\n\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(gghighlight)\n\n\nusstates &lt;- st_transform(usstates, crs = eqdc)\ncountbound &lt;- st_transform(countbound, crs = eqdc)\nuscities_sf &lt;- st_transform(uscities_sf, crs = eqdc)\n\nData:\n\ntop10 &lt;- uscities_sf %&gt;%\n  arrange(desc(population)) %&gt;%\n  slice(1:10)\n\n\nggplot() +\n  geom_sf(data = countbound, fill = \"grey95\", color = \"black\", lty = \"dashed\") +\n  geom_sf(data = usstates, fill = NA, color = \"black\", lwd = 0.5) +\n  geom_sf(data = top10, color = \"red\", size = 2) +\n  geom_label_repel(data = top10, \n                   aes(geometry = geometry, label = city), \n                   stat = \"sf_coordinates\", \n                   size = 3, max.overlaps = Inf) +\n  theme_minimal() +\n  labs(title = \"Top 10 Most Populous US Cities with State and Country Boundaries\")\n\n\n\n\n\n\n\n\nThe figure above shows the US border and state borders in solid lines and the mexico and Canada borders in dashed lines. I have highlighted the most populated US cities which Include Chicago, Philadelphia, Boston, Los Angeles, Dallas, Washington, New York, Atlanta, Miami and Houston.\nCity Distance from the Border:\n\nfar_usa &lt;- uscities_sf %&gt;%\n  arrange(desc(usborder_dist)) %&gt;%\n  slice(1:5)\n\n\nuscities_sf &lt;- uscities_sf %&gt;%\n  mutate(\n    usborder_dist = as.numeric(usborder_dist),\n    state_border_dist = as.numeric(state_border_dist),\n    mex_dist = as.numeric(mex_dist),\n    can_dist = as.numeric(can_dist)\n  )\n\n\nggplot() +\n  geom_sf(data = usstates, fill = NA, color = \"black\") +\n  geom_sf(data = uscities_sf, aes(color = usborder_dist), size = 0.5) +\n  scale_color_viridis_c(name = \"Distance to National Border (km)\") +\n  geom_sf(data = far_usa, color = \"red\", size = 1.5) +\n  geom_label_repel(data = far_usa, \n                   aes(geometry = geometry, label = city),\n                   stat = \"sf_coordinates\", size = 3) +\n  theme_minimal() +\n  labs(title = \"Distance of US Cities from National Border\")\n\n\n\n\n\n\n\n\nThe map above shows a color gradient of the distance of cities from the US border. I have highlighted the five cities farthest from the border.\nCity Distance From Nearest State:\n\nfar_state_border &lt;- uscities_sf %&gt;%\n  arrange(desc(state_border_dist)) %&gt;%\n  slice(1:5)\n\n\nggplot() +\n  geom_sf(data = usstates, fill = NA, color = \"black\") +\n  geom_sf(data = uscities_sf, aes(color = state_border_dist), size = 0.5) +\n  scale_color_viridis_c(name = \"Distance to State Border (km)\") +\n  geom_sf(data = far_state_border, color = \"blue\", size = 1.5) +\n  geom_label_repel(data = far_state_border,\n                   aes(geometry = geometry, label = city),\n                   stat = \"sf_coordinates\", size = 3) +\n  theme_minimal() +\n  labs(title = \"Distance of US Cities from Nearest State Border\")\n\n\n\n\n\n\n\n\nThe map above shows a color gradient that represents cities distances from their state borders. I have highlighted the five cities farthest from a state border.\nEquidistance boundary from Mexico and Canada\n\nuscities_sf &lt;- uscities_sf %&gt;%\n  mutate(diff_can_mex = abs(can_dist - mex_dist))\n\n\neq_cities &lt;- uscities_sf %&gt;%\n  filter(diff_can_mex &lt; 100)\n\n\ntop5_eq &lt;- eq_cities %&gt;%\n  arrange(desc(population)) %&gt;%\n  slice(1:5)\n\n\nggplot() +\n  geom_sf(data = usstates, fill = NA, color = \"gray\") +\n  geom_sf(data = eq_cities, aes(color = diff_can_mex), size = 0.5) +\n  scale_color_viridis_c(name = \"Difference in Dist (km)\") +\n  gghighlight(diff_can_mex &lt; 100) +\n  geom_label_repel(data = top5_eq,\n                   aes(geometry = geometry, label = city),\n                   stat = \"sf_coordinates\", size = 3) +\n  theme_minimal() +\n  labs(title = \"US Cities Equidistant to Canada and Mexico (±100 km)\")\n\nWarning: Could not calculate the predicate for layer 1; ignored\n\n\n\n\n\n\n\n\n\nThe map above shows a line of cities that are nearly equidistant from the Canada and Mexico borders within a 100 km . The labeled cities are those that are the most populated of the list. These include Salt lake City, UT, Provo, UT, Fort Collins, CO, Greely, CO, and Topeka KS."
  },
  {
    "objectID": "lab10.html#question-4",
    "href": "lab10.html#question-4",
    "title": "Lab 10: Distances and the Border Zone",
    "section": "Question 4:",
    "text": "Question 4:\nQuantifying the Border Zone:\n\nborder_cities &lt;- uscities_sf %&gt;%\n  filter(pmin(usborder_dist, mex_dist, can_dist, na.rm = TRUE) &lt;= 160)\n\n\nnum_zone &lt;- nrow(border_cities)\n\n\nzone_pop &lt;- sum(border_cities$population, na.rm = TRUE)\n\n\ntotal_pop &lt;- sum(uscities_sf$population, na.rm = TRUE)\n\n\nperc_zone &lt;- (zone_pop / total_pop) * 100\n\n\nborder_summary &lt;- tibble(\n  `# Cities in Zone` = num_zone,\n  `Population in Zone` = zone_pop,\n  `Total Population` = total_pop,\n  `Percent in Zone` = round(perc_zone, 2)\n)\n\nflextable(border_summary)\n\n# Cities in ZonePopulation in ZoneTotal PopulationPercent in Zone9,821216,048,530396,228,55854.53\n\n\n\nThere are 9,821 cities in the 100 mile zone\nThere are 216,048,530 people living in the cities within this zone\n54.53% of the total population lives within this zone.\nThe ACLU article predicts that 2/3 of the population lives in the 100 mile border zone. This is an overestimate, because it is closer to 1/2 of the population.\n\nMapping The Border Zone:\n\nggplot() +\n  geom_sf(data = usstates, fill = NA, color = \"gray\") +\n  geom_sf(\n    data = border_cities,\n    aes(color = usborder_dist),\n    size = 0.7\n  ) +\n  scale_color_gradient(low = \"orange\", high = \"darkred\", name = \"Distance to Border (km)\") +\n  gghighlight(TRUE) +\n  geom_label_repel(\n    data = border_cities %&gt;%\n      arrange(desc(population)) %&gt;%\n      slice(1:10),\n    aes(geometry = geometry, label = city),\n    stat = \"sf_coordinates\",\n    size = 3\n  ) +\n  theme_minimal() +\n  labs(title = \"US Cities Within 100 Miles of a Border — Colored by Distance\")\n\n\n\n\n\n\n\n\nThe map above shows all of the US cities within 100m miles of the border. The gradient refers to the distance each city is from the border. The labeled cities are the most populated cities within this border zone. These include Detroit, New York, Boston, Philadelphia, Miami, Houston, San Diego, Los Angeles, San Francisco and Seattle.\nMost Populous Cities in The Danger Zone:\n\ntop_per_state &lt;- border_cities %&gt;%\n  group_by(state_name) %&gt;%\n  slice_max(order_by = population, n = 1, with_ties = FALSE) %&gt;%\n  ungroup()\n\n\nggplot() +\n  geom_sf(data = usstates, fill = NA, color = \"gray\") +\n  geom_sf(\n    data = border_cities,\n    aes(color = usborder_dist),\n    size = 0.7\n  ) +\n  scale_color_gradient(low = \"orange\", high = \"darkred\", name = \"Distance to Border (km)\") +\n  gghighlight(TRUE) +\n  geom_label_repel(\n    data = top_per_state,\n    aes(geometry = geometry, label = city),\n    stat = \"sf_coordinates\",\n    size = 3\n  ) +\n  theme_minimal() +\n  labs(title = \"Most Populous City in Each State Within the 100-Mile Border Zone\")\n\nWarning: ggrepel: 9 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n\n\n\n\n\n\n\n\n\nThe map above shows all of the US cities within 100m miles of the border. The gradient refers to the distance each city is from the border. The labeled cities are the most populated cities in each state within this border zone."
  }
]